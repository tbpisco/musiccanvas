var app=function(e){var o={};o.canvas,o.context,o.interval=null,o.objects=[],o.mouse={x:0,y:0},o.star,o.ns=25,o.initialSize=10,o.initialSizeRange=2,o.sources=["sons/C.mp3","sons/D.mp3","sons/E.mp3","sons/F.mp3","sons/G.mp3","sons/A.mp3","sons/B.mp3"],o.sounds=[],o.playing=[],o.audioLoad=0,o.isClick=!1,o.isMobile=!1,o.init=function(){o.canvas=e("canvas")[0],o.updateSizeCanvas(),o.context=o.canvas.getContext("2d"),o.starImage=new Image,o.starImage.src="imgs/star.png",e(document).ready(function(){"computer"!==o.detectDevice()&&(o.isMobile=!0),o.initSounds(),o.consoleText()}),e(window).resize(function(){o.updateSizeCanvas()})},o.updateSizeCanvas=function(){o.canvas.width=e(window).width(),o.canvas.height=e(window).height()},o.initSounds=function(){for(o.isMobile&&(o.ns=25,o.initialSize=25,o.initialSizeRange=10),i=0;i<o.ns;i++)o.sounds.push([]);for(i=0;i<o.sources.length;i++)for(j=0;j<o.ns;j++)o.sounds[j].push(new Audio(o.sources[i]));for(i=0;i<o.sources.length;i++)o.playing[i]=0;o.addEventCheckAudioLoad(),o.isMobile?(o.initSoundsMobile(),o.isMobile=!0):e(".loading p").html("0%<br>Loading")},o.addEventCheckAudioLoad=function(){for(i=0;i<o.sources.length;i++)for(j=0;j<o.ns;j++)o.sounds[j][i].addEventListener("loadeddata",o.checkAudioLoad,!1)},o.initSoundsMobile=function(){e(".loading p").html("Music Canvas<br>Click here!"),o.isMobile?(e("canvas")[0].addEventListener("touchstart",o.playAllSoundsMute),e(".loading")[0].addEventListener("touchstart",o.playAllSoundsMute)):(e("canvas")[0].addEventListener("click",o.playAllSoundsMute),e(".loading")[0].addEventListener("click",o.playAllSoundsMute))},o.playAllSoundsMute=function(){e(".loading p").html("0%<br>Loading");for(var t=0;t<o.ns;t++)for(var i=0;i<o.sources.length;i++)o.playSound(i,0);for(var t=0;t<o.ns;t++)for(var i=0;i<o.sources.length;i++)o.sounds[t][i].pause();o.isMobile?e("canvas")[0].removeEventListener("touchstart",o.playAllSoundsMute):e("canvas")[0].removeEventListener("click",o.playAllSoundsMute)},o.checkAudioLoad=function(){o.audioLoad++;var t=o.sources.length*o.ns;e(".loading p").html(Math.floor(o.audioLoad/t*100)+"%<br>Loading"),o.audioLoad>=t&&(e(".loading p").html("Click to play!"),e("canvas")[0].addEventListener("mousemove",function(e){o.isMobile||(o.mouse=o.getMousePos(e))}),o.isMobile?(e("canvas")[0].addEventListener("touchstart",o.clickonscreen),e(".loading")[0].addEventListener("touchstart",o.clickonscreen)):(e("canvas")[0].addEventListener("click",o.clickonscreen),e(".loading")[0].addEventListener("click",o.clickonscreen)),o.interval=setInterval(o.loop,1e3/12))},o.clickonscreen=function(t){if(o.isClick||(e(".loading").hide(),o.isClick=!0),o.mouse=o.getMousePos(t),o.objects.length<o.ns)if(o.isMobile){for(var i=o.mouse.x,n=o.mouse.y,s=-1,a=0;a<o.objects.length;a++)if(i>o.objects[a].x-o.objects[a].width/2&&i<o.objects[a].x+o.objects[a].width&&n>o.objects[a].y-o.objects[a].height/2&&n<o.objects[a].y+o.objects[a].height){s=a;break}-1===s&&(o.create(o.mouse),s=o.objects.length-1),o.objects[s].over=!0,setTimeout(function(){o.objects[s].over=!1},1e3/12-1);for(var c=0;c<o.sources.length;c++)o.objects[a].size==o.initialSize+o.initialSizeRange*Math.abs(c-6)&&o.playSound(c,1)}else o.create(o.mouse)},o.playSound=function(e,t){1>=t&&t>=0?o.sounds[o.playing[e]][e].volume=t:o.sounds[o.playing[e]][e].volume=1,o.sounds[o.playing[e]][e].play(),++o.playing[e],o.playing[e]>=o.ns&&(o.playing[e]=0)},o.create=function(e){positionX=e.x,positionY=e.y;var t=Math.floor(3*Math.random())+2,i=Math.floor(2*Math.random())+2,n=12*Math.floor(3*Math.random()),s=o.initialSize+o.initialSizeRange*Math.floor(7*Math.random());o.star=new Star({context:o.context,posX:positionX,posY:positionY,quantidade:n,velocidadeY:i,velocidadeRotacao:t,size:s}),o.objects.push(o.star)},o.loop=function(){o.context.clearRect(0,0,o.canvas.width,o.canvas.height);for(var t=[],i=0;i<o.objects.length;i++)o.objects[i].desenhar(),o.objects[i].y-o.objects[i].height/2>e(window).height()&&t.push(i);for(var i=0;i<t.length;i++)o.objects.splice(t[i],1);if(!o.isMobile)for(var n=o.mouse.x,s=o.mouse.y,i=0;i<o.objects.length;i++)if(n>o.objects[i].x-o.objects[i].width/2&&n<o.objects[i].x+o.objects[i].width&&s>o.objects[i].y-o.objects[i].height/2&&s<o.objects[i].y+o.objects[i].height){if(o.objects[i].over=!0,0==o.objects[i].countCirculos)for(var a=0;a<o.sources.length;a++)o.objects[i].size==o.initialSize+o.initialSizeRange*Math.abs(a-6)&&o.playSound(a,1)}else o.objects[i].over=!1;o.context.drawImage(o.starImage,10,10,40,40),o.context.font="30px BELLABOO-Regular",o.context.fillStyle="white",o.context.fillText(o.ns-o.objects.length,54,40)},o.getMousePos=function(o){var t=e(e(".music-painting")[0]).offset().left,i=e(e(".music-painting")[0]).offset().top,n=o.clientX||o.touches[0].clientX,s=o.clientY||o.touches[0].clientY;return{x:Math.floor(n-t+e("body").scrollLeft()),y:Math.floor(s-i+e("body").scrollTop())}},o.detectBrowser=function(){var e,o;if(/Firefox[\/\s](\d+\.\d+)/.test(navigator.userAgent)){e="firefox";var t=new Number(RegExp.$1);o=Math.floor(t)}if(/MSIE (\d+\.\d+);/.test(navigator.userAgent)){e="internet explorer";var i=new Number(RegExp.$1);o=Math.floor(i)}if(/Opera[\/\s](\d+\.\d+)/.test(navigator.userAgent)){e="opera";var n=new Number(RegExp.$1);o=Math.floor(n)}navigator.userAgent.toLowerCase().indexOf("chrome")>-1&&-1!=navigator.userAgent.toLowerCase().indexOf("safari")&&(e="chrome",o=""),-1==navigator.userAgent.toLowerCase().indexOf("chrome")&&-1!=navigator.userAgent.toLowerCase().indexOf("safari")&&(e="safari",o="")},o.detectDevice=function(){var e;return e=navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPod/i)||navigator.userAgent.match(/iPad/i)?"iosdevice":navigator.userAgent.match(/Android/i)?"android":navigator.userAgent.match(/BlackBerry/i)?"blackberry":navigator.userAgent.match(/IEMobile/i)?"iemobile":navigator.userAgent.match(/Silk/i)?"kindle":"computer"},o.gotoWebsite=function(){window.open("http://www.thatianepisco.com")},o.consoleText=function(){console.log("%c made with <3 ","background: #E9ECEC; color: #8C254E"),console.log("%c by Thatiane Pisco - www.thatianepisco.com","background: #E9ECEC; color: #8C254E"),console.log("%c Would you like to see more? -> seeMore()","background: #E9ECEC; color: #8C254E")},o.init(),window.seeMore=o.gotoWebsite}($);